import { useEffect, useMemo, useState } from 'react'

export default function App() {
  const [lang, setLang] = useState('en')
  const [active, setActive] = useState('services')
  const [scrolled, setScrolled] = useState(false)
  const [openPostId, setOpenPostId] = useState(null) // ุตูุญุฉ ุงูููุงู ุงูููุชูุญ
  const [lightboxOpen, setLightboxOpen] = useState(false)
  const [lightboxSrc, setLightboxSrc] = useState(null)
  const rtl = lang === 'ar'

  // ุฃููุงู ุงููููุฉ
  const PRIMARY = '#0B4CA1'
  const PRIMARY_DARK = '#093E84'
  const ACCENT = '#1E90FF'
  const SOFT_BG = '#F5F8FF'
  const WHATSAPP = '#25D366'

  // ุชุฑุฌูุฉ
  const dict = useMemo(
    () => ({
      en: {
        brandSmall: 'Audit & Consulting',
        nav: {
          services: 'Services',
          process: 'Process',
          about: 'About',
          blog: 'Blog',
          infograph: 'Infograph',
          contact: 'Contact',
        },
        switch: 'ุงูุนุฑุจูุฉ',
        hero: 'Audit & Consulting Services You Can Trust',
        desc: 'We help SMEs build confidence in their numbers with clear audits, practical advice and on-time delivery.',
        ctaExplore: 'Explore Services',
        servicesTitle: 'Our Services',
        processTitle: 'How We Work',
        aboutTitle: 'About The Bridge',
        blogTitle: 'Blog',
        infographTitle: 'Infograph',
        contactTitle: 'Book a Free Consultation',
        contactDesc: 'Tell us about your needs and weโll get back within 24 hours.',
        whatsapp: 'WhatsApp',
        readMore: 'Read more โ',
        backToList: 'Back to blog list',
        back: 'Back',
        view: 'View',
        form: {
          name: 'Your Name',
          email: 'Email',
          phone: 'Phone (optional)',
          message: 'How can we help?',
          send: 'Send',
          sending: 'Sendingโฆ',
          ok: 'Thanks! We received your message.',
          err: 'Something went wrong. Please try again.',
        },
      },
      ar: {
        brandSmall: 'ุงูุชุฏููู ูุงูุงุณุชุดุงุฑุงุช',
        nav: {
          services: 'ุงูุฎุฏูุงุช',
          process: 'ุขููุฉ ุงูุนูู',
          about: 'ูู ูุญู',
          blog: 'ุงูููุงูุงุช',
          infograph: 'ุงูุงูููุฌุฑุงู',
          contact: 'ุชูุงุตู',
        },
        switch: 'EN',
        hero: 'ุฎุฏูุงุช ุชุฏููู ูุงุณุชุดุงุฑุงุช ูุงููุฉ ููููู ุงููุซูู ุจูุง',
        desc: 'ูุณุงุนุฏ ุงูุดุฑูุงุช ุงูุตุบูุฑุฉ ูุงููุชูุณุทุฉ ุนูู ุจูุงุก ุงูุซูุฉ ูู ุฃุฑูุงููุง ูู ุฎูุงู ุชุฏููู ูุงุถุญ ูุชูุตูุงุช ุนูููุฉ ูุชุณููู ูู ุงูููุช ุงููุญุฏุฏ.',
        ctaExplore: 'ุฎุฏูุงุชูุง',
        servicesTitle: 'ุงูุฎุฏูุงุช',
        processTitle: 'ุขููุฉ ุงูุนูู',
        aboutTitle: 'ูู ูุญู',
        blogTitle: 'ุงูููุงูุงุช',
        infographTitle: 'ุงูุงูููุฌุฑุงู',
        contactTitle: 'ุงุญุฌุฒ ุงุณุชุดุงุฑุฉ ูุฌุงููุฉ',
        contactDesc: 'ุงุฐูุฑ ุงุญุชูุงุฌุงุชู ูุณูุนุงูุฏ ุงูุชูุงุตู ุฎูุงู 24 ุณุงุนุฉ.',
        whatsapp: 'ูุงุชุณุงุจ',
        readMore: 'ุงูุฑุฃ ุงููุฒูุฏ โ',
        backToList: 'ุนูุฏุฉ ุฅูู ูุงุฆูุฉ ุงูููุงูุงุช',
        back: 'ุนูุฏุฉ',
        view: 'ุนุฑุถ',
        form: {
          name: 'ุงูุงุณู',
          email: 'ุงูุจุฑูุฏ ุงูุฅููุชุฑููู',
          phone: 'ุงููุงุชู (ุงุฎุชูุงุฑู)',
          message: 'ูุง ุงูุฐู ุชุญุชุงุฌูุ',
          send: 'ุฅุฑุณุงู',
          sending: 'ุฌุงุฑู ุงูุฅุฑุณุงูโฆ',
          ok: 'ุดูุฑูุง ูู! ุชู ุงุณุชูุงู ุฑุณุงูุชู.',
          err: 'ุญุฏุซ ุฎุทุฃุ ุญุงูู ูุฑุฉ ุฃุฎุฑู.',
        },
      },
    }),
    [lang]
  )

  // ุงูุฎุฏูุงุช
  const services = [
    { icon: '๐', en: 'Audit & Assurance', ar: 'ุงูุชุฏููู ูุงููุฑุงุฌุนุฉ' },
    { icon: 'โ', en: 'Limited Review (SMEs)', ar: 'ุงููุฑุงุฌุนุฉ ุงููุญุฏูุฏุฉ ููุดุฑูุงุช ุงูุตุบูุฑุฉ' },
    { icon: '๐ก๏ธ', en: 'Internal Audit', ar: 'ุงูุชุฏููู ุงูุฏุงุฎูู' },
    { icon: '๐งพ', en: 'Tax Advisory & Returns', ar: 'ุงูุงุณุชุดุงุฑุงุช ุงูุถุฑูุจูุฉ ูุงูุฅูุฑุงุฑุงุช' },
    { icon: '๐', en: 'Compliance & Quality', ar: 'ุงูุงูุชุซุงู ูุงูุฌูุฏุฉ' },
    { icon: 'โ๏ธ', en: 'Accounting System Setup', ar: 'ุฅุนุฏุงุฏ ุงูุฃูุธูุฉ ุงููุญุงุณุจูุฉ' },
    { icon: '๐', en: 'Financial Reporting & KPIs', ar: 'ุงูุชูุงุฑูุฑ ูุงููุคุดุฑุงุช ุงููุงููุฉ' },
    { icon: '๐ค', en: 'Advisory Retainers', ar: 'ุฎุฏูุงุช ุงุณุชุดุงุฑูุฉ ูุณุชูุฑุฉ' },
    { icon: '๐ผ', en: 'Business Valuation', ar: 'ุชูููู ุงูุฃุนูุงู' },
  ]

  // ุงูุฎุทูุงุช
  const steps = [
    { n: 1, en: 'Discovery', ar: 'ุงูุงุณุชูุดุงู' },
    { n: 2, en: 'Proposal', ar: 'ุงูุนุฑุถ' },
    { n: 3, en: 'Fieldwork', ar: 'ุงูุนูู ุงูููุฏุงูู' },
    { n: 4, en: 'Delivery', ar: 'ุงูุชุณููู' },
  ]

  // ุงูููุงูุงุช
  const posts = [
    {
      id: 'post-1',
      titleAr: 'ููุงุฐุง ูุฌูุฏ ูุฑุงุฌุน ุญุณุงุจุงุช ูุจู ุงูุงุณุชุซูุงุฑ ุถุฑูุฑุฉ ุฃุณุงุณูุฉุ',
      excerptAr:
        'ุชุนุฑู ุนูู ุงูุฃุณุจุงุจ ุงูุชู ุชุฌุนู ูุฌูุฏ ูุฑุงุฌุน ุญุณุงุจุงุช ูุจู ุถุฎ ุฃููุงู ุงููุณุชุซูุฑูู ูู ุฃู ุดุฑูุฉ ุฎุทูุฉ ุถุฑูุฑูุฉ ูููุณุช ูุฌุฑุฏ ุฅุฌุฑุงุก ุดููู.',
      contentAr: (
        <>
          <p className="mb-3">
            <strong>1. ุงูุชุฃูุฏ ูู ุตุญุฉ ุงูุจูุงูุงุช ุงููุงููุฉ</strong><br />
            ุงููุณุชุซูุฑ ูุนุชูุฏ ุนูู ุงูููุงุฆู ุงููุงููุฉ ููุดุฑูุฉ (ุงูุฃุฑุจุงุญุ ุงูุฎุณุงุฆุฑุ ุงูุฃุตููุ ุงูุงูุชุฒุงูุงุช)โฆ
          </p>
          <p className="mb-3"><strong>2. ุงููุดู ุนู ุงููุฎุงุทุฑ ูุงููุดุงูู ุงููุฎููุฉ</strong><br />โฆ</p>
          <p className="mb-3"><strong>3. ุชูุฏูุฑ ุงููููุฉ ุงูุนุงุฏูุฉ ููุดุฑูุฉ</strong><br />โฆ</p>
          <p className="mb-3"><strong>4. ุชุนุฒูุฒ ุงูุดูุงููุฉ ูุงูุซูุฉ</strong><br />โฆ</p>
          <p className="mb-3"><strong>5. ุงูุชูุงูู ูุน ุงูููุงููู ูุงูุถุฑุงุฆุจ</strong><br />โฆ</p>
          <p className="mb-3"><strong>6. ุญูุงูุฉ ุฃููุงู ุงููุณุชุซูุฑ</strong><br />โฆ</p>
        </>
      ),
      titleEn: 'Why Having an Auditor Before Investment is Essential',
      excerptEn:
        'Discover why an independent audit is crucial for investors before committing fundsโnot just a box-ticking formality.',
      contentEn: (
        <>
          <p className="mb-3"><strong>1. Verifying Financial Data</strong><br />โฆ</p>
          <p className="mb-3"><strong>2. Revealing Hidden Risks</strong><br />โฆ</p>
          <p className="mb-3"><strong>3. Fair Valuation</strong><br />โฆ</p>
          <p className="mb-3"><strong>4. Transparency & Trust</strong><br />โฆ</p>
          <p className="mb-3"><strong>5. Legal & Tax Compliance</strong><br />โฆ</p>
          <p className="mb-3"><strong>6. Safeguarding Funds</strong><br />โฆ</p>
        </>
      ),
    },
    {
      id: 'post-2',
      titleAr: 'ููุงุฐุง ุชุญุชุงุฌ ุงูุดุฑูุงุช ุงููุงุดุฆุฉ ูุงูุตุบูุฑุฉ ูุงููุชูุณุทุฉ ุฅูู ูุฑุงุฌุน ุญุณุงุจุงุช ุฏุงุฎููุ',
      excerptAr:
        'ูุฌูุฏ ูุฑุงุฌุน ุฏุงุฎูู ูุณุชูู ูุถูู ูุชุงุจุนุฉ ุฏูุฑูุฉ ููุดู ุงููุงูุน ุงููุงูู ููุดุฑูุฉุ ุจูุง ูุชุฌุงูุฒ ูุฌุฑุฏ ุงูุงูุชุซุงู ุงูุณููู.',
      contentAr: (
        <>
          <p className="mb-3"><strong>ูู ูุนุธู ุงูุฏูู</strong>โฆ</p>
          <p className="mb-3"><strong>1. ุงูุชูููู ุจูู ุงูููุฒุงููุฉ ุงูุฑุณููุฉ ูุงูููุฒุงููุฉ ุงููุงูุนูุฉ</strong><br />โฆ</p>
          <p className="mb-3"><strong>2. ุงูุญูุงูุฉ ูู ุงูุฃุฎุทุงุก ูุงููุณุงุฏ</strong><br />โฆ</p>
          <p className="mb-3"><strong>3. ุชุญุณูู ููุงุกุฉ ุงูุฅุฏุงุฑุฉ ุงููุงููุฉ</strong><br />โฆ</p>
          <p className="mb-3"><strong>4. ุจูุงุก ุงูุซูุฉ ูุน ุงูุดุฑูุงุก ูุงููุณุชุซูุฑูู</strong><br />โฆ</p>
          <p className="mb-3"><strong>5. ุงูุชููู ูุน ุงุฎุชูุงู ุงูููุงููู ุจูู ุงูุฏูู</strong><br />โฆ</p>
          <p className="mb-3"><strong>ุงูุฎูุงุตุฉ</strong><br />โฆ</p>
        </>
      ),
      titleEn: 'Why Do Startups and SMEs Need an Internal Auditor?',
      excerptEn:
        'An internal, independent auditor provides ongoing oversight and a true financial pictureโbeyond annual statutory compliance.',
      contentEn: (
        <>
          <p className="mb-3"><strong>In many countries</strong>โฆ</p>
          <p className="mb-3"><strong>1. Reconciling Official vs. Actual Budgets</strong><br />โฆ</p>
          <p className="mb-3"><strong>2. Protection from Errors and Fraud</strong><br />โฆ</p>
          <p className="mb-3"><strong>3. Improving Financial Management Efficiency</strong><br />โฆ</p>
          <p className="mb-3"><strong>4. Building Trust with Partners and Investors</strong><br />โฆ</p>
          <p className="mb-3"><strong>5. Adapting to Cross-Country Legal Differences</strong><br />โฆ</p>
          <p className="mb-3"><strong>Bottom line</strong><br />โฆ</p>
        </>
      ),
    },
  ]

  // ูุชุญ/ุฅุบูุงู ุงูููุงู (hash routing ุจุณูุท)
  const openPost = (id) => {
    setOpenPostId(id)
    const newHash = `#blog/${id}`
    if (location.hash !== newHash) history.pushState({ post: id }, '', newHash)
    requestAnimationFrame(() => {
      document.getElementById('blog')?.scrollIntoView({ behavior: 'smooth' })
    })
  }
  const closePost = () => {
    setOpenPostId(null)
    if (location.hash.startsWith('#blog/')) history.pushState({}, '', '#blog')
    document.getElementById('blog')?.scrollIntoView({ behavior: 'smooth' })
  }

  // ุฏุนู ุฒุฑ ุงูุฑุฌูุน + ูุฑุงุกุฉ ุงููุงุด
  useEffect(() => {
    const handleHash = () => {
      const m = location.hash.match(/^#blog\/(post-[^\/#]+)/)
      if (m && m[1]) setOpenPostId(m[1])
      else setOpenPostId(null)
    }
    handleHash()
    window.addEventListener('popstate', handleHash)
    window.addEventListener('hashchange', handleHash)
    return () => {
      window.removeEventListener('popstate', handleHash)
      window.removeEventListener('hashchange', handleHash)
    }
  }, [])

  // Scroll spy (ูุดูู infograph)
  useEffect(() => {
    const ids = ['services', 'process', 'about', 'blog', 'infograph', 'contact']
    const secs = ids.map((id) => document.getElementById(id)).filter(Boolean)
    if (!('IntersectionObserver' in window) || secs.length === 0) return
    const obs = new IntersectionObserver(
      (entries) => entries.forEach((e) => e.isIntersecting && setActive(e.target.id)),
      { rootMargin: '-120px 0px -60% 0px', threshold: 0.1 }
    )
    secs.forEach((s) => obs.observe(s))
    return () => obs.disconnect()
  }, [])

  // ุชูููู ุงููุงูุจุงุฑ ุนูุฏ ุงูุชูุฑูุฑ
  useEffect(() => {
    const onScroll = () => setScrolled(window.scrollY > 10)
    onScroll()
    window.addEventListener('scroll', onScroll)
    return () => window.removeEventListener('scroll', onScroll)
  }, [])

  // ุฅุบูุงู ุงููุงูุชุจููุณ ุจู ESC
  useEffect(() => {
    const onKey = (e) => {
      if (e.key === 'Escape') setLightboxOpen(false)
    }
    window.addEventListener('keydown', onKey)
    return () => window.removeEventListener('keydown', onKey)
  }, [])

  const navClass = (id) =>
    `transition-colors ${active === id ? 'font-semibold underline underline-offset-8' : ''}`

  // ูุชุญ ุงููุงูุชุจููุณ
  const openLightbox = (src) => {
    setLightboxSrc(src)
    setLightboxOpen(true)
  }

  return (
    <div dir={rtl ? 'rtl' : 'ltr'} className="min-h-screen bg-slate-50 text-slate-900">

      {/* NAVBAR */}
      <header
        className={`sticky top-0 z-50 backdrop-blur border-b ${scrolled ? 'shadow-md' : ''}`}
        style={{
          background: scrolled
            ? `linear-gradient(135deg, ${PRIMARY} 0%, ${ACCENT} 100%)`
            : 'rgba(255,255,255,0.85)',
        }}
      >
        <div className="max-w-6xl mx-auto flex items-center justify-between px-4 py-3">
          <a href="#top" className="flex items-center gap-3">
            <img src="/logo.png" alt="logo" className="w-10 h-10" />
            <div>
              <div
                className="font-semibold"
                style={{ color: scrolled ? '#fff' : PRIMARY }}
              >
                The Bridge
              </div>
              <div
                className="text-xs"
                style={{ color: scrolled ? '#EEF2FF' : '#64748B' }}
              >
                {dict[lang].brandSmall}
              </div>
            </div>
          </a>
          <nav className="hidden md:flex gap-6 text-sm">
            <a href="#services" className={navClass('services')}>{dict[lang].nav.services}</a>
            <a href="#process" className={navClass('process')}>{dict[lang].nav.process}</a>
            <a href="#about" className={navClass('about')}>{dict[lang].nav.about}</a>
            <a href="#blog" className={navClass('blog')}>{dict[lang].nav.blog}</a>
            <a href="#infograph" className={navClass('infograph')}>{dict[lang].nav.infograph}</a>
            <a href="#contact" className={navClass('contact')}>{dict[lang].nav.contact}</a>
          </nav>
          <button
            onClick={() => setLang(lang === 'en' ? 'ar' : 'en')}
            className="px-3 py-1 border rounded"
          >
            {dict[lang].switch}
          </button>
        </div>
      </header>

      {/* HERO */}
      <a id="top" />
      <section
        className="text-center py-20 text-white"
        style={{ background: `linear-gradient(135deg, ${PRIMARY} 0%, ${ACCENT} 100%)` }}
      >
        <h1 className="text-4xl font-bold">{dict[lang].hero}</h1>
        <p className="mt-3 max-w-2xl mx-auto">{dict[lang].desc}</p>
        <div className="mt-6 flex gap-4 justify-center">
          <a href="#services" className="px-4 py-2 text-white rounded" style={{ backgroundColor: PRIMARY_DARK }}>
            {dict[lang].ctaExplore}
          </a>
          <a href="https://wa.me/96879434422" className="px-4 py-2 text-white rounded" style={{ backgroundColor: WHATSAPP }}>
            {dict[lang].whatsapp}
          </a>
        </div>
      </section>

      {/* SERVICES */}
      <section id="services" className="py-14 text-center scroll-mt-24" style={{ background: SOFT_BG }}>
        <h2 className="text-2xl font-bold" style={{ color: PRIMARY }}>{dict[lang].servicesTitle}</h2>
        <div className="mt-8 grid sm:grid-cols-2 lg:grid-cols-3 gap-6 max-w-6xl mx-auto px-4">
          {services.map((s, i) => (
            <div key={i} className="p-6 bg-white rounded-2xl border hover:shadow transition">
              <div className="text-4xl">{s.icon}</div>
              <h3 className="mt-3 font-semibold">{lang === 'ar' ? s.ar : s.en}</h3>
            </div>
          ))}
        </div>
      </section>

      {/* PROCESS */}
      <section
        id="process"
        className="py-14 text-center text-white border-y border-slate-200 scroll-mt-24"
        style={{ background: `linear-gradient(135deg, ${PRIMARY} 0%, ${ACCENT} 100%)` }}
      >
        <h2 className="text-2xl font-bold">{dict[lang].processTitle}</h2>
        <div className="mt-8 grid sm:grid-cols-2 lg:grid-cols-4 gap-6 max-w-6xl mx-auto px-4">
          {steps.map((s) => (
            <div key={s.n} className="p-6 bg-white text-slate-900 rounded-2xl border">
              <div className="font-bold text-xl" style={{ color: PRIMARY }}>0{s.n}</div>
              <div className="mt-2">{lang === 'ar' ? s.ar : s.en}</div>
            </div>
          ))}
        </div>
      </section>

      {/* ABOUT */}
      <section id="about" className="py-14 text-center max-w-3xl mx-auto px-4 scroll-mt-24">
        <h2 className="text-2xl font-bold">{dict[lang].aboutTitle}</h2>
        <p className="mt-4 text-slate-600">
          {lang === 'en'
            ? 'At The Bridge, we provide simplified and effective audit and consulting solutions tailored for startups and small businesses. We ensure competitive pricing without compromising quality, delivering accurate reports and practical recommendations that help our clients build trust and make better decisions.'
            : 'ูุญู ูู The Bridge ูููุฑ ุญููู ุชุฏููู ูุงุณุชุดุงุฑุงุช ูุงููุฉ ูุจุณุทุฉ ููุนูุงูุฉุ ููุฌูุฉ ุฎุตูุตูุง ููุดุฑูุงุช ุงููุงุดุฆุฉ ูุงูุตุบูุฑุฉ. ูุถูู ูุนููุงุฆูุง ุฃุณุนุงุฑูุง ููุงุณุจุฉ ุฏูู ุงููุณุงุณ ุจุงูุฌูุฏุฉุ ูุน ุชูุฏูู ุชูุงุฑูุฑ ุฏูููุฉ ูุชูุตูุงุช ุนูููุฉ ุชุณุงุนุฏูู ุนูู ุจูุงุก ุงูุซูุฉ ูู ุฃุนูุงููู ูุงุชุฎุงุฐ ูุฑุงุฑุงุช ุฃูุถู.'}
        </p>
      </section>

      {/* BLOG (ูุงุฆูุฉ ุฃู ุตูุญุฉ ุฏุงุฎููุฉ) */}
      <section id="blog" className="py-16 bg-white border-t border-slate-200 scroll-mt-24">
        <div className="mx-auto max-w-6xl px-4">
          <h2 className="text-2xl md:text-3xl font-bold mb-6 text-center">{dict[lang].blogTitle}</h2>

          {/* ุงููุงุฆูุฉ */}
          {!openPostId && (
            <div className="space-y-6">
              {posts.map((p) => (
                <article
                  key={p.id}
                  className={`p-6 bg-slate-50 rounded-2xl shadow hover:shadow-md transition ${rtl ? 'text-right' : 'text-left'}`}
                >
                  <h3 className="text-xl font-semibold text-blue-800 mb-2 text-center">
                    {lang === 'ar' ? p.titleAr : p.titleEn}
                  </h3>
                  <p className="text-slate-600 mb-3 text-center max-w-4xl mx-auto">
                    {lang === 'ar' ? p.excerptAr : p.excerptEn}
                  </p>
                  <div className={rtl ? 'text-left' : 'text-right'}>
                    <a
                      href={`#blog/${p.id}`}
                      onClick={(e) => { e.preventDefault(); openPost(p.id) }}
                      className="text-blue-600 hover:underline"
                    >
                      {dict[lang].readMore}
                    </a>
                  </div>
                </article>
              ))}
            </div>
          )}

          {/* ุงูุชูุงุตูู */}
          {openPostId && (
            <BlogDetail
              lang={lang}
              rtl={rtl}
              post={posts.find((x) => x.id === openPostId)}
              onBack={closePost}
              dict={dict}
            />
          )}
        </div>
      </section>

      {/* INFOGRAPH */}
      <section id="infograph" className="py-16 bg-slate-50 border-t border-slate-200 scroll-mt-24">
        <div className="mx-auto max-w-6xl px-4 text-center">
          <h2 className="text-2xl md:text-3xl font-bold mb-8">{dict[lang].infographTitle}</h2>

          <div className="grid md:grid-cols-2 gap-6">
            {/* Card 1 */}
            <figure className="bg-white rounded-2xl shadow p-4 flex flex-col">
              <img
                src="/infograph1.png"
                alt="Infograph 1"
                className="w-full rounded-lg cursor-zoom-in"
                onClick={() => openLightbox('/infograph1.png')}
              />
              <figcaption className="mt-3 text-sm text-slate-600 flex items-center justify-between">
                <span>{lang === 'ar' ? 'ููุงุฐุง ูุฌูุฏ ูุฑุงุฌุน ุญุณุงุจุงุช ูุจู ุงูุงุณุชุซูุงุฑ' : 'Why an auditor before investing'}</span>
                <button
                  onClick={() => openLightbox('/infograph1.png')}
                  className="px-3 py-1 text-xs border rounded hover:bg-slate-50"
                >
                  {dict[lang].view}
                </button>
              </figcaption>
            </figure>

            {/* Card 2 */}
            <figure className="bg-white rounded-2xl shadow p-4 flex flex-col">
              <img
                src="/infograph2.png"
                alt="Infograph 2"
                className="w-full rounded-lg cursor-zoom-in"
                onClick={() => openLightbox('/infograph2.png')}
              />
              <figcaption className="mt-3 text-sm text-slate-600 flex items-center justify-between">
                <span>{lang === 'ar' ? 'ููุงุฐุง ุชุญุชุงุฌ ุงูุดุฑูุงุช ูุฑุงุฌุนูุง ุฏุงุฎูููุง' : 'Why an internal auditor'}</span>
                <button
                  onClick={() => openLightbox('/infograph2.png')}
                  className="px-3 py-1 text-xs border rounded hover:bg-slate-50"
                >
                  {dict[lang].view}
                </button>
              </figcaption>
            </figure>
          </div>
        </div>
      </section>

      {/* CONTACT */}
      <section id="contact" className="py-16 scroll-mt-24" style={{ background: SOFT_BG }}>
        <div className="mx-auto max-w-2xl px-4 text-center">
          <h2 className="text-2xl md:text-3xl font-bold">{dict[lang].contactTitle}</h2>
          <p className="mt-2 text-slate-600">{dict[lang].contactDesc}</p>
          <ContactForm lang={lang} dict={dict} />
          <div className="mt-4 flex justify-center">
            <a href="https://wa.me/96879434422" className="rounded-2xl px-5 py-3 text-white font-medium shadow" style={{ backgroundColor: WHATSAPP }}>
              {dict[lang].whatsapp}
            </a>
          </div>
        </div>
      </section>

      {/* FOOTER */}
      <footer className="py-6 text-center border-t text-slate-500 text-sm">
        ยฉ {new Date().getFullYear()} The Bridge Audit & Consulting
      </footer>

      {/* LIGHTBOX MODAL */}
      {lightboxOpen && (
        <div
          className="fixed inset-0 z-[60] bg-black/70 backdrop-blur-sm flex items-center justify-center p-4"
          onClick={() => setLightboxOpen(false)}
        >
          <div
            className="relative max-w-6xl w-full"
            onClick={(e) => e.stopPropagation()}
          >
            <button
              onClick={() => setLightboxOpen(false)}
              className="absolute -top-10 right-0 md:right-2 bg-white/90 hover:bg-white text-slate-700 rounded-full px-3 py-1 text-sm shadow"
            >
              {dict[lang].back}
            </button>
            <img
              src={lightboxSrc || ''}
              alt="Infograph full"
              className="w-full h-auto rounded-lg shadow-2xl"
            />
          </div>
        </div>
      )}
    </div>
  )
}

/* === ููููู ุตูุญุฉ ุงูููุงู === */
function BlogDetail({ lang, rtl, post, onBack, dict }) {
  if (!post) return null
  return (
    <article className="max-w-3xl mx-auto">
      <div className={`flex ${rtl ? 'justify-start' : 'justify-end'} mb-4`}>
        <button onClick={onBack} className="px-4 py-2 rounded border text-sm hover:bg-slate-50">
          {dict[lang].back}
        </button>
      </div>
      <h1 className="text-3xl font-bold text-slate-900 text-center">
        {lang === 'ar' ? post.titleAr : post.titleEn}
      </h1>
      <div className={`prose prose-slate max-w-none mt-6 ${lang === 'ar' ? 'text-right' : 'text-left'}`}>
        {lang === 'ar' ? post.contentAr : post.contentEn}
      </div>
      <div className={`mt-8 ${rtl ? 'text-left' : 'text-right'}`}>
        <button onClick={onBack} className="text-blue-600 hover:underline">
          {dict[lang].backToList}
        </button>
      </div>
    </article>
  )
}

/* === ูููุฐุฌ ุงูุชูุงุตู (Formspree) === */
function ContactForm({ lang, dict }) {
  const [submitting, setSubmitting] = useState(false)
  const [status, setStatus] = useState(null)
  const [form, setForm] = useState({
    name: '',
    email: '',
    phone: '',
    message: '',
    _gotcha: '',
  })

  const handleSubmit = async (e) => {
    e.preventDefault()
    if (form._gotcha) return
    setSubmitting(true)
    setStatus(null)
    try {
      const res = await fetch('https://formspree.io/f/xpwjznko', {
        method: 'POST',
        headers: {
          Accept: 'application/json',
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ ...form, lang }),
      })
      setStatus(res.ok ? 'ok' : 'err')
      if (res.ok) setForm({ name: '', email: '', phone: '', message: '', _gotcha: '' })
    } catch {
      setStatus('err')
    } finally {
      setSubmitting(false)
    }
  }

  const rtl = lang === 'ar'

  return (
    <form
      onSubmit={handleSubmit}
      className={`mt-6 bg-white p-6 rounded-2xl shadow-md space-y-4 ${rtl ? 'text-right' : 'text-left'}`}
    >
      {/* honeypot */}
      <input
        type="text"
        name="_gotcha"
        value={form._gotcha}
        onChange={(e) => setForm({ ...form, _gotcha: e.target.value })}
        className="hidden"
        tabIndex={-1}
        autoComplete="off"
      />

      <input
        type="text"
        name="name"
        required
        value={form.name}
        onChange={(e) => setForm({ ...form, name: e.target.value })}
        placeholder={dict[lang].form.name}
        className="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500"
      />
      <input
        type="email"
        name="email"
        required
        value={form.email}
        onChange={(e) => setForm({ ...form, email: e.target.value })}
        placeholder={dict[lang].form.email}
        className="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500"
      />
      <input
        type="tel"
        name="phone"
        value={form.phone}
        onChange={(e) => setForm({ ...form, phone: e.target.value })}
        placeholder={dict[lang].form.phone}
        className="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500"
      />
      <textarea
        name="message"
        rows="4"
        required
        value={form.message}
        onChange={(e) => setForm({ ...form, message: e.target.value })}
        placeholder={dict[lang].form.message}
        className="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500"
      />

      <div className={`mt-2 flex ${rtl ? 'justify-start' : 'justify-end'}`}>
        <button
          type="submit"
          disabled={submitting}
          className="min-w-32 bg-blue-600 text-white py-3 px-5 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-60"
        >
          {submitting ? dict[lang].form.sending : dict[lang].form.send}
        </button>
      </div>

      {status === 'ok' && <div className="text-green-600 text-sm">{dict[lang].form.ok}</div>}
      {status === 'err' && <div className="text-red-600 text-sm">{dict[lang].form.err}</div>}
    </form>
  )
}
